2025-11-18 09:43:52,993 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:43:53,049 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:43:53,079 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:43:53,138 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:43:57,214 [WARNING] âš ï¸ Parquet nÃ£o encontrado ou invÃ¡lido, rodando ETL completo
2025-11-18 09:43:57,215 [INFO] ğŸ“¥ Lendo base de dados: data/solicitacoes.xlsx
2025-11-18 09:43:57,217 [ERROR] âŒ Erro ao carregar Excel
Traceback (most recent call last):
  File "C:\Users\jhona\Desktop\projeto Monitoramento\core\etl.py", line 33, in preparar_base
    df = pd.read_excel(CAMINHO_EXCEL)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1550, in __init__
    ext = inspect_excel_format(
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1402, in inspect_excel_format
    with get_handle(
         ^^^^^^^^^^^
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\common.py", line 882, in get_handle
    handle = open(handle, ioargs.mode)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/solicitacoes.xlsx'
2025-11-18 09:45:52,301 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:45:52,330 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:45:52,340 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:45:52,350 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:45:55,163 [WARNING] âš ï¸ Parquet nÃ£o encontrado ou invÃ¡lido, rodando ETL completo
2025-11-18 09:45:55,163 [INFO] ğŸ“¥ Lendo base de dados: data/dados_solicitacoes.xlsx
2025-11-18 09:45:55,975 [INFO] ğŸ§ª Base tratada com sucesso.
2025-11-18 09:49:41,600 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:49:41,615 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:49:41,625 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:49:41,641 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:49:44,780 [WARNING] âš ï¸ Parquet nÃ£o encontrado ou invÃ¡lido, rodando ETL completo.
2025-11-18 09:49:44,781 [INFO] ğŸ“¥ Lendo base de dados: data/dados_solicitacoes.xlsx
2025-11-18 09:49:45,466 [INFO] âœ… Colunas carregadas: ['NÃºmero da SolicitaÃ§Ã£o', 'OrgÃ£o', 'Unidade gestora', 'Tipo da solicitaÃ§Ã£o', 'NÃºmero da ata', 'Objeto', 'NÃºcleo Pertencente', 'Data da solicitaÃ§Ã£o', 'SituaÃ§Ã£o  do Processo', 'SituaÃ§Ã£o Atual', 'Andamento no PE Integrado', 'ComparaÃ§Ã£o', 'ResponsÃ¡vel', 'Andamento SEI', 'Encaminhado / Setor', 'SEI', 'Status da Coluna M']
2025-11-18 09:49:45,468 [INFO] ğŸ”— Coluna SEI detectada como 'SEI' e convertida para string.
2025-11-18 09:49:45,470 [WARNING] âš ï¸ NÃ£o foi possÃ­vel calcular lead_time (faltam colunas de data de entrada/finalizaÃ§Ã£o).
2025-11-18 09:49:45,470 [INFO] ğŸ§ª Base tratada com sucesso.
2025-11-18 09:49:45,472 [INFO] ğŸ”„ Coluna 'SEI' convertida para string antes de salvar Parquet.
2025-11-18 09:49:45,527 [INFO] ğŸ’¾ Base salva como Parquet em: data/solicitacoes_processadas.parquet
2025-11-18 09:49:45,529 [ERROR] Erro ao aplicar SLA
Traceback (most recent call last):
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Tipo SolicitaÃ§Ã£o'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jhona\Desktop\projeto Monitoramento\core\sla.py", line 21, in aplicar_sla
    df["sla_final"] = df["Tipo SolicitaÃ§Ã£o"].apply(lambda x: MULTIPLIERS.get(str(x).strip(), 1) * SLA_PADRAO)
                      ~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jhona\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'Tipo SolicitaÃ§Ã£o'
2025-11-18 09:51:51,295 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:51:51,314 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:51:51,331 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:51:51,343 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:51:54,904 [INFO] ğŸ”„ Base carregada de Parquet: data/solicitacoes_processadas.parquet
2025-11-18 09:51:54,906 [WARNING] âš ï¸ Coluna 'Tipo SolicitaÃ§Ã£o' nÃ£o encontrada. Usando SLA padrÃ£o para todos.
2025-11-18 09:51:54,909 [INFO] âœ… Regras de SLA aplicadas com sucesso.
2025-11-18 09:51:54,912 [WARNING] âš ï¸ Coluna 'status_macro' nÃ£o encontrada para cÃ¡lculo de cancelamento.
2025-11-18 09:51:54,919 [WARNING] âš ï¸ Coluna de responsÃ¡vel tÃ©cnico nÃ£o encontrada para risco.
2025-11-18 09:51:54,923 [INFO] âš ï¸ Risco calculado com sucesso.
2025-11-18 09:54:49,543 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:54:49,555 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:54:49,564 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:54:49,591 [INFO] ğŸ” Logging inicializado com sucesso.
2025-11-18 09:54:52,556 [INFO] ğŸ”„ Base carregada de Parquet: data/solicitacoes_processadas.parquet
2025-11-18 09:54:52,558 [WARNING] âš ï¸ Coluna 'Tipo SolicitaÃ§Ã£o' nÃ£o encontrada. Usando SLA padrÃ£o para todos.
2025-11-18 09:54:52,563 [INFO] âœ… Regras de SLA aplicadas com sucesso.
2025-11-18 09:54:52,567 [WARNING] âš ï¸ Coluna 'status_macro' nÃ£o encontrada para cÃ¡lculo de cancelamento.
2025-11-18 09:54:52,574 [WARNING] âš ï¸ Coluna de responsÃ¡vel tÃ©cnico nÃ£o encontrada para risco.
2025-11-18 09:54:52,578 [INFO] âš ï¸ Risco calculado com sucesso.
2025-11-18 09:54:52,594 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:54:52,599 [INFO] ğŸ“Š KPIs executivos calculados com sucesso.
2025-11-18 09:54:52,612 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:54:52,619 [INFO] ğŸ” Funil operacional calculado.
2025-11-18 09:54:53,026 [INFO] ğŸ”¥ Top processos crÃ­ticos carregados.
2025-11-18 09:54:53,131 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:54:53,139 [INFO] ğŸ“Š KPIs executivos calculados com sucesso.
2025-11-18 09:54:53,141 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:54:53,145 [INFO] ğŸ” Funil operacional calculado.
2025-11-18 09:54:53,148 [INFO] ğŸ”¥ Top processos crÃ­ticos carregados.
2025-11-18 09:55:12,221 [INFO] ğŸ”„ Base carregada de Parquet: data/solicitacoes_processadas.parquet
2025-11-18 09:55:12,224 [WARNING] âš ï¸ Coluna 'Tipo SolicitaÃ§Ã£o' nÃ£o encontrada. Usando SLA padrÃ£o para todos.
2025-11-18 09:55:12,229 [INFO] âœ… Regras de SLA aplicadas com sucesso.
2025-11-18 09:55:12,238 [WARNING] âš ï¸ Coluna 'status_macro' nÃ£o encontrada para cÃ¡lculo de cancelamento.
2025-11-18 09:55:12,244 [WARNING] âš ï¸ Coluna de responsÃ¡vel tÃ©cnico nÃ£o encontrada para risco.
2025-11-18 09:55:12,249 [INFO] âš ï¸ Risco calculado com sucesso.
2025-11-18 09:55:12,269 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:55:12,278 [INFO] ğŸ“Š KPIs executivos calculados com sucesso.
2025-11-18 09:55:12,291 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:55:12,294 [INFO] ğŸ” Funil operacional calculado.
2025-11-18 09:55:12,360 [INFO] ğŸ”¥ Top processos crÃ­ticos carregados.
2025-11-18 09:55:12,450 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:55:12,457 [INFO] ğŸ“Š KPIs executivos calculados com sucesso.
2025-11-18 09:55:12,459 [WARNING] âš ï¸ Nenhuma coluna de status encontrada. 'status_macro' definido como 'Indefinido'.
2025-11-18 09:55:12,461 [INFO] ğŸ” Funil operacional calculado.
2025-11-18 09:55:12,463 [INFO] ğŸ”¥ Top processos crÃ­ticos carregados.
